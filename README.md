# گزارش طراحی سیستم برای پروژه‌ی To-Do List API

## 1. چرا به To-Do API نیاز داریم؟
یک To-Do لیست به کاربران امکان مدیریت وظایف روزانه را می‌دهد. این API پایه برای ساخت اپلیکیشن‌های وب و موبایل مفید است:

- پیاده‌سازی RESTful API ساده  
- استفاده در پروژه‌های تمرینی برای یادگیری Express، Docker، Kubernetes  
- قابلیت توسعه برای کار با پایگاه‌داده و احراز هویت  

---

## 2. نیازمندی‌ها و اهداف سیستم

### اهداف عملکردی:
- افزودن وظایف جدید با `POST /tasks`
- نمایش لیست وظایف با `GET /tasks`
- مشاهده جزئیات یک وظیفه با `GET /tasks/:id`
- حذف یک وظیفه با `DELETE /tasks/:id`

### اهداف غیرعملکردی:
- سریع و ساده برای تست (تاخیر کمتر از 100ms)
- توسعه‌پذیر برای آینده (قابل اتصال به پایگاه‌داده)
- پشتیبانی از مقیاس‌پذیری با Kubernetes و Docker

---

## 3. برآورد ظرفیت و محدودیت‌ها

### در حالت فعلی (In-memory):
- همه وظایف در RAM ذخیره می‌شوند
- با افزایش تعداد وظایف یا کاربر، داده‌ها بعد از restart از بین می‌روند
- مناسب برای محیط‌های تست یا مقیاس کوچک

### در حالت توسعه‌یافته:
- ذخیره در دیتابیس واقعی مثل MongoDB یا PostgreSQL
- پشتیبانی از میلیون‌ها وظیفه و کاربران

---

## 4. طراحی APIها (System APIs)

| Method | Endpoint       | عملکرد                            |
|--------|----------------|----------------------------------|
| GET    | /tasks         | لیست همه وظایف                   |
| POST   | /tasks         | ایجاد وظیفه جدید                 |
| GET    | /tasks/:id     | گرفتن وظیفه بر اساس ID          |
| DELETE | /tasks/:id     | حذف وظیفه بر اساس ID            |
| GET    | /health        | بررسی سلامت سرویس برای Kubernetes probes |

---

## 5. طراحی پایگاه‌داده (در حال حاضر: حافظه موقت)

در حال حاضر داده‌ها به صورت زیر در حافظه ذخیره می‌شوند:

```javascript
let tasks = [
  { id: 1, title: "Buy groceries", done: false },
  { id: 2, title: "Finish report", done: false }
];
```
## 6. طراحی سیستم و الگوریتم‌ها

- **ID اتوماتیک**: توسط متغیر `taskIdCounter`
- **افزودن تسک**: وظیفه جدید به آرایه `tasks[]` اضافه می‌شود
- **حذف تسک**: با فیلتر کردن `tasks` بر اساس `id`
- **دریافت تسک**: با استفاده از `find()` در آرایه
- **Health Check**: مسیر `/health` همیشه پاسخ `200 OK` بازمی‌گرداند

---

## 7. پارتیشن‌بندی و تکرار داده‌ها

فعلاً نیازی به پارتیشن‌بندی یا تکرار داده‌ها نیست، چون داده‌ها به‌صورت محلی در حافظه ذخیره می‌شوند.

---

## 8. استفاده از Cache

در حال حاضر داده‌ها به‌صورت مستقیم در حافظه قرار دارند و نیازی به استفاده از Cache جداگانه نیست.

---

## 9. لود بالانسر

در Kubernetes، سرویس از طریق `todo-service` در فایل `service.yaml` مدیریت می‌شود.

برای مشاهده سرویس در Minikube، از دستور زیر استفاده می‌شود:

```bash
minikube service todo-service
```
## 10. پاک‌سازی داده‌ها

در حال حاضر حذف وظایف از طریق `DELETE /tasks/:id` انجام می‌شود.

### برنامه برای نسخه‌های آینده:
- حذف خودکار وظایفی که بیش از ۳۰ روز عمر دارند
- افزودن قابلیت حذف گروهی یا زمان‌بندی شده

---

## 11. امنیت و مجوزها

### وضعیت فعلی:
- هیچ احراز هویتی (Authentication) پیاده‌سازی نشده است
- مکانیزم Rate Limiting برای کنترل درخواست‌ها وجود ندارد

### برنامه برای نسخه‌های آینده:
- افزودن JWT برای احراز هویت کاربران
- بررسی داده‌ی ورودی (مثلاً اطمینان از خالی نبودن `title`)
- جلوگیری از حملات XSS و SQL Injection
- محدود کردن تعداد درخواست‌ها در هر دقیقه با استفاده از `express-rate-limit`

