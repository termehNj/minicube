# minicube

```
Minikube
```
## درس : رایانش ابری

## استاد مربوطه: دکتر شریفی

## 1400442145 – ترمه نجارآذری

## 1404 بهار


## مقدمه 0

## سازی یک میکروسرویس ساده با استفاده از این گزارش کار روند پیاده

```
، Docker ، کانتینریزه کردن آن با Node.jsدر Express ورکفریم
دهد. همچنین، را توضیح می Kubernetes و در نهایت استقرار آن در
سازی پذیری و نظارت بر وضعیت سرویس نیز پیادهقابلیت مقیاس
.شودمی
```
## طراحی برنامه 1 فاز

```
API To-Do در این فاز، ابتدا یک میکروسرویس ساده به عنوان
Express ورکبا استفاده از فریم API شود. اینطراحی میList
هایی مانند افزودن، حذف، شود و قابلیتسازی میپیاده Node.js در
.و نمایش وظایف را دارد
```
```
:به صورت زیر است API کد
```
## که به صورت میکروسرویس در حال اجرا API برای تست اپلیکیشن

```
.استفاده کنید Postman توانید ازاست، می
ها است و امکان ارسال APIیک ابزار عالی برای تست Postman
.کندها را فراهم میها و مشاهده پاسخدرخواست
```

```
ل برای هم به این شک deleteرده و از ک postتا تسک دیگر هم چند
تفاده میکنیم: ت استس
```
```
Dockerکانتینریزه کردن با 2 فاز
شود. برای تبدیل می Docker در این فاز، اپلیکیشن به یک کانتینر
ایجاد کرد که نحوه ساخت Dockerfile این کار، ابتدا باید یک
.اندازی کانتینر را مشخص کندو راه
:برای اپلیکیشن Dockerfile
```
```
: Dockerدستورهای ساخت و اجرای
```
```
: Docker Hubارسال ایمیج به
```
Kubernetesاستقرار در 3 فاز
یااباد. ابتادااساااتقرار می Kubernetes در این فااز، اپلیکیشااان در
برای اساتقرار YAML هایشاود، سا س فایلاندازی میراه Minikube
.شودبرنامه و سرویس ایجاد می
: Minikubeاندازیراه

```
:) Serviceو Deployment) برای استقرار YAML هایایجاد فایل
```

## : YAMLهایاعمال فایل

## :دسترسی به سرویس

## پذیری و نظارتمقیاس 4 فاز

## پذیری و نظارت برای اپلیکیشن فعال در این فاز، قابلیت مقیاس

## .شودمی

```
:Manual Scaling
```
```
(Pods) پادهای گویید که تعدادمی Kubernetes با این دستور به
افزایش دهد. این کار عدد 3 را بهtodo-app مربوط به اپلیکیشن
:شودباعث می
```
```
.کانتینر مجزا اجرا شود 3 اپلیکیشن شما در •
(Load Balancing).پاد تقسیم شود 3 ترافیک بین این •
تحمل خطای سیستم افزایش یابد (اگر یکی از پادها خراب •
.مانند)شود، دو تای دیگر باقی می
```
```
:HPA
تعداد خودکار صورتاست که به Kubernetes یک ابزار در HPA |
.کندتنظیم می CPU پادهای اپلیکیشن را بر اساس مصرف
CPU اگر میانگین استفاده از : --cpu-percent=50 •
گیرد تصمیم میHPA برسد، 50 ٪توسط پادها به بیشتر از
.که پادهای بیشتری بسازد
```
```
.پاد همیشه فعال باشد 2 حداقل : --min=2 •
.پاد افزایش یابد 5 تواند تا حداکثر می: --max=5 •
```
به فایل **Readiness Probe** و **Liveness Probe** افزودن
ها برای اطمینان ازیکی از بهترین روش deployment.yaml
.است Kubernetes سرویس در پذیری دسترس و پایداری
پروب زنده بودن - Liveness Probe

```
هنوز زنده و در حال کند که آیا اپلیکیشنبررسی می: هدف •
.اجراست یا نه
ریستارت کانتینر را: Kubernetes اگر شکست بخورد •
.کندمی
زمانی که ممکن است اپلیکیشن دچار مشکل : مناسب برای •
پایان شود ولی همچنان در حال اجرا بماند (مثلاً در حلقه بی
.گیر کند)
```
```
پروب آمادگی - Readiness Probe
```
```
آماده دریافت کند که آیا اپلیکیشنبررسی می: هدف •
.هست یا نه ترافیک
آن پاد را موقتاً از: Kubernetes اگر شکست بخورد •
کند ولی آن را ریستارت خارج میload balancing
.کندنمی
کشد تا زمانی که اپلیکیشن مدتی طول می: مناسب برای •
.آماده شود (مثلاً اتصال به پایگاه داده)
```

```
به فایل Liveness/Readiness Probe افزودن
:deployment.yaml
```
```
کنند تا وضعیت کمک می Kubernetes به Probe هایاین فایل
ها روی پادهایی که هنوز سرویس را بررسی کند و از بارگذاری درخواست
.آماده نیستند جلوگیری کند
```
```
To-Do List APIیگزارش طراحی سیستم برای پروژه
```
```
نیاز داریم؟ To-Do API چرا به. 1
```
```
لیست به کاربران امکان مدیریت وظایف روزانه را To-Do یک
های وب و موبایل مفید پایه برای ساخت اپلیکیشن API دهد. اینمی
:است
```
```
ساده RESTful API سازیپیاده •
، Expressهای تمرینی برای یادگیریاستفاده در پروژه •
Kubernetes ،Docker
داده و احراز هویتقابلیت توسعه برای کار با پایگاه •
```
## ها و اهداف سیستم نیازمندی. 2

## :اهداف عملکردی

POST /tasks با افزودن وظایف جدید •
GET /tasks با نمایش لیست وظایف •
GET /tasks/:id با مشاهده جزئیات یک وظیفه •
DELETE /tasks/:id با حذف یک وظیفه •

```
:اهداف غیرعملکردی
```
```
ms) 100 تر از تاخیر کم (سریع و ساده برای تست •
داده) پذیر برای آینده (قابل اتصال به پایگاهتوسعه •
Dockerو Kubernetes پذیری باپشتیبانی از مقیاس •
```
## ها برآورد ظرفیت و محدودیت. 3

```
(In-memory):در حالت فعلی
```
```
شوندذخیره می RAM همه وظایف در •
رود بعد ازها از بین میبا افزایش تعداد وظایف یا کاربر، داده •
restart
های تست یا مقیاس کوچک مناسب برای محیط •
```

## :یافته در حالت توسعه

```
یا MongoDB ذخیره در دیتابیس واقعی مثل •
PostgreSQL
شود ها وظیفه و کاربران پشتیبانی میمیلیون •
```
```
(System APIs)ها APIطراحی. 4
```
```
Method Endpoint عملکرد
GET^ /tasks لیست همه وظایف
POST^ /tasks ایجاد وظیفه جدید
GET^ /tasks/:id IDگرفتن وظیفه بر اساس
DELETE^ /tasks/:id IDحذف وظیفه بر اساس
GET^ /health بررسی سلامت سرویس
Kubernetes برای
probes
```
## داده (در حال حاضر: حافظه موقت) طراحی پایگاه. 5

## :شوندها به صورت زیر در حافظه ذخیره میدر حال حاضر داده

```
let tasks = [
{ id: 1, title: "Buy groceries",
done: false },
{ id: 2, title: "Finish report",
done: false }
];
```
```
:توان ازبرای آینده می
```
```
schema بدون MongoDB •
.استفاده کرد )رتدقیق schema با( PostgreSQL •
```
## ها طراحی سیستم و الگوریتم. 6

```
taskIdCounter توسط متغیر: اتوماتیک ID •
شود اضافه میtasks[] وظیفه جدید به: افزودن تسک •
id بر اساسtasks با فیلتر کردن: حذف تسک •
در آرایه find() با: دریافت تسک •
```
```
همیشه /health مسیر :Health Check •
گرداند رمیب 200 OK
```
## ها بندی و تکرار داده پارتیشن. 7

## .ها محلی هستندفعلاً نیازی نیست چون داده

```
Cacheاستفاده از. 8
```
```
Cache ها مستقیم در حافظه هستند و نیاز بهدر حال حاضر داده
.نیست
```
## لود بالانسر. 9

```
در todo-service ، سرویس از طریق Kubernetesدر
.شودمدیریت می service.yaml فایل
:شود، با دستور زیر باز می Minikubeدر
```
```
minikube service todo-service
```
```
:باشد، آدرس مثلاً NodePort برابر type اگر
```
```
http://127.0.0.1:32156/
```
```
.خواهد بود
```
## ها سازی داده پاک. 10

.شود انجام می DELETE/tasks/id در حال حاضر حذف با
:های بعدیدر نسخه

روز دارند به صورت خودکار حذف 30 هایی که بیش از تسک •
شوند
بندی شده اضافه شود امکان حذف گروهی یا زمان •


## امنیت و مجوزها. 11

## :در حال حاضر

## هیچ احراز هویتی وجود ندارد •

```
اعمال نشده است Rate Limiting هیچ •
```
```
:های آیندهبرای نسخه
```
برای کاربران JWT Auth افزودن •
title) ی ورودی (مثلاً خالی نبودنبررسی داده •
XSS / Injectionجلوگیری از حملات •
محدود کردن تعداد درخواست در هر دقیقه با •
express-rate-limit


